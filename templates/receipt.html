{% extends "base.html" %}
{% block title %}Receipt{% endblock %}
{% block pageName %}{% endblock %}

{% block content %}
{{ error }}
<div style="margin-top: 120px;">
<div class="container pt-5 my-5 p-4 mt-10 rounded shadow" style="background-color: #f8f9fa; border-left: 8px solid #2d572c;">
    <div class="text-center mb-4">
        <h2 class="text-success">Receipt</h2>
        <p class="lead">Thanks for shopping with us!</p>
    </div>

    <div class="row mb-4">
        <div class="col-md-6">
            <h5 class="text-muted">Bill To:</h5>
            <p class="mb-1">{{ user.first_name }} {{ user.last_name }}</p>
            <p class="mb-1">{{ user.address }}, {{ user.post_code }}</p>
            <p class="mb-1">{{ user.state }}, {{ user.country }}</p>
        </div>
        <div class="col-md-6 text-end">
            <p><strong>Receipt No:</strong> 
                {% set order_id = order|first%}
                {{order_id.order_id}}
            </p>
        </div>
    </div>

    <div class="row mb-4">
        <div class="col-md-6">
            <h5 class="text-muted">Ship To:</h5>
            <p class="mb-1">{{ user.shipping_address }}, {{ user.shipping_post_code }}</p>
            <p class="mb-1">{{ user.shipping_state }}, {{ user.shipping_country }}</p>
        </div>
    </div>

    <div class="table-responsive mb-4">
        <table class="table table-bordered align-middle">
            <thead class="table-success text-center">
                <tr>
                    <th>#</th>
                    <th>Item</th>
                    <th>Price</th>
                    <th>Quantity</th>
                    <th>Subtotal</th>
                </tr>
            </thead>
            <tbody>
                {% for item in order %}
                <tr>
                    <td class="text-center">{{ loop.index }}</td>
                    <td>{{ order[item] }}</td>
                    <td class="text-end">${{ item.price }}</td>
                    <td class="text-center">{{ item.quantity }}</td>
                    <td class="text-end">${{ item.price * item.quantity }}</td>
                </tr>
                {% endfor %}
            </tbody>
            <tfoot>
                {% set totals = [] %}
                {% for item in order %}
                    {% if totals.append(item.quantity * item.price) %}{% endif %}
                {% endfor %}
                {% set total = totals | sum %}
                <tr class="table-light">
                    <th colspan="4" class="text-end">Total</th>
                    <th class="text-end text-success">${{ total }}</th>
                </tr>
            </tfoot>
        </table>
    </div>
</div>
</div>

<script type='text/javascript' src="static/checkout.js"></script>
{% endblock %}
